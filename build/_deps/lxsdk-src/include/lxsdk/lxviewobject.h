/*
 * LX viewobject module
 *
 * Copyright 0000
 */
#ifndef LX_viewobject_H
#define LX_viewobject_H

typedef struct vt_ILxViewObject ** ILxViewObjectID;





/*
 * The TestMode function is used to test if a draw pass type is available. It is
 * called with a single type, such as BBox or Surface. If the function returns
 * LXe_TRUE, it has been generated and is available. If the function returns
 * LXe_FALSE, the Generate function should be called to generate that data. The
 * function can also return LXe_NOTREADY to specify that the ViewObject is working
 * on generating the data in a thread, or LXe_NOTAVAILABLE if the requested data is
 * not supported.
 * 
 * The Flags method allows the ViewObject to declare some properties that determine
 * how it should be evaluated.
 * 
 * If the TestMode function has declared that work needs to be done to generate
 * the ViewObject data, the Generate function will be called. It is expected to
 * generate new draw passes of the requested type. This function may be called from
 * threads if that is supported.
 * 
 * 
 * The Count method is expected to return the number of available draw passes of
 * the requested type.
 * 
 * The ByIndex method is expected to return draw passes by index of the requested
 * type.
 * 
 * If the ViewObject drawing varies per viewport, this function will be called. It
 * is expected to return a copy of itself, configured to generate draw passes for
 * the provided viewport.
 */
typedef struct vt_ILxViewObject {
	ILxUnknown	 iunk;
	LXxMETHOD( LxResult,
TestMode) (
	LXtObjectID		  self,
	unsigned int		  type);
	LXxMETHOD( unsigned int,
Flags) (
	LXtObjectID		  self);
	LXxMETHOD( void,
Generate) (
	LXtObjectID		  self,
	unsigned int		  type);
	LXxMETHOD( unsigned int,
Count) (
	LXtObjectID		  self,
	unsigned int		  type);
	LXxMETHOD( LxResult,
ByIndex) (
	LXtObjectID		  self,
	unsigned int		  type,
	unsigned int		  index,
	void			**ppvObj);
	LXxMETHOD( LxResult,
ByView) (
	LXtObjectID		  self,
	LXtObjectID		  view,
	void			**ppvObj);
} ILxViewObject;

/*
 * The ILxViewObject is used to generate passes that are used for drawing. It is
 * usually generated by a modifier attached to an item that wishes to draw. At draw
 * time, the passes (also ILxViewObjects) are generated and passed to the drawing
 * loop.
 */

	#define	LXu_VIEWOBJECT			"81C986D1-A7BA-4278-B060-E784779F5C36"
	#define LXa_VIEWOBJECT			"viewobject"
	// [local] ILxViewObject
	// [export] ILxViewObject		viewobj
	// [python] ILxViewObject:ByIndex	obj ViewObject
	// [python] ILxViewObject:ByView	obj ViewObject
	// [default] ILxViewObject:TestMode = LXe_NOTAVAILABLE
	// [default] ILxViewObject:Flags = 0
	// [default] ILxViewObject:Count = 0

/*
 * - BBOX_FAST
 * This is the simplest draw type. This bounding box should be fast to generate
 * and can be used until a slower bounding box is calculated.
 * - BBOX
 * This pass represents a bounding box. In most cases, this will be identical to
 * BBOX_FAST, but in some cases may be slower to calculate.
 * - WIREFRAME
 * The wireframe pass is a line drawing of the surface wireframe.
 * 
 * - SURFACE
 * The surface pass is triangles with normals.
 * 
 * - TEXTURED
 * The textured pass is triangles, with normals and UV coordinates.
 * 
 */

	#define	LXiVIEWPASS_BBOX_FAST		0
	#define	LXiVIEWPASS_BBOX		1
	#define	LXiVIEWPASS_WIREFRAME		2
	#define	LXiVIEWPASS_SURFACE		3
	#define	LXiVIEWPASS_TEXTURED		4
	#define LXiVIEWPASS_COUNT		5

/*
 * - NOTHREADS
 * The ViewObject data will be generated in a single thread.
 * - PERVIEW
 * The ViewObject drawing varies per viewport, and seperate passes should be
 * generated for each view.
 */

	#define	LXfVIEWOBJECT_NOTHREADS		0x01
	#define	LXfVIEWOBJECT_PERVIEW		0x02

/*
 * Items declare that they can provide a ViewObject with a package server tag giving
 * the name of the channel that contains the ILxViewObject. Read in an evaluated
 * context, this will be a ValueReference object channel holding the ILxViewObject.
 */

	#define LXsPKG_VIEWOBJECT_CHANNEL	"viewObject.channel"

#endif